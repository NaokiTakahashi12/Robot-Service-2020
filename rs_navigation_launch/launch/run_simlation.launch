<?xml version="1.0"?>
<launch>
  <!-- Arguments -->
  <!-- For neonavigation parameter -->
  <arg name="use_path_with_velocity" default="true"/>
  <arg name="vel" default="1.11"/>
  <arg name="use_safety_limiter" default="false"/>
  <arg name="cmd_vel_output" default="/cmd_vel"/>
  <!-- 
    map_identity is file name without file extension
    ex) map_identity = "map" -> map.yaml, map_local.yaml
  -->
  <arg name="map_idendity" default="cit3f"/>
  <arg name="robot_name" default="orne_alpha"/>
  <!-- Arguments end -->
  <!-- neonavigation navigate -->
  <include file="$(find rs_navigation_launch)/launch/navigate.launch">
    <arg name="map_file" value="$(find rs_navigation_map)/map/$(arg map_idendity).yaml"/>
    <arg name="cmd_vel_output" value="$(arg cmd_vel_output)"/>
    <arg name="use_safety_limiter" value="$(arg use_safety_limiter)"/>
    <arg name="use_path_with_velocity" value="$(arg use_path_with_velocity)"/>
    <arg name="vel" value="$(arg vel)"/>
    <arg name="robot_name" value="$(arg robot_name)"/>
  </include>
  <!-- Load local map -->
  <node pkg="map_server" type="map_server" name="map_server_local" args="$(find rs_navigation_map)/map/$(arg map_idendity)_local.yaml">
    <remap from="map" to="map_with_local_objects"/>
    <param name="hz" value="0.5"/>
  </node>
  <!-- Local costmap from map_server -->
  <node pkg="costmap_cspace" type="largemap_to_map" name="largemap_to_map">
    <remap from="map" to="map_with_local_objects"/>
    <remap from="map_local" to="overlay1"/>
    <param name="width" value="60"/>
    <param name="hz" value="2"/>
    <param name="round_local_map" value="true"/>
    <param name="simulate_occlusion" value="true"/>
  </node>
  <!-- @todo Save waypoints file in follow_waypoint package -->
  <!-- @todo Required /initialpose -->
  <node pkg="follow_waypoints" type="follow_waypoints" name="follow_waypoints">
    <param name="goal_frame_id" value="map"/>
    <param name="wayopint_distance_tolerance" value="4"/>
  </node>
  <!-- Simulation only -->
  <node pkg="planner_cspace" type="dummy_robot" name="dummy_robot">
    <remap from="cmd_vel" to="$(arg cmd_vel_output)"/>
  </node>
  <!-- Simulation only -->
  <node pkg="tf2_ros" type="static_transform_publisher" name="stf1" args="0 0 0 0 0 0 map odom"/>
  <node pkg="rviz" type="rviz" name="rviz" args="-d $(find rs_navigation_config)/rviz/simulate_visualization.rviz" respawn="true"/>
</launch>
